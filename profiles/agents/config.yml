---
# yaml-language-server: $schema=../../schemas/config.schema.json
# Agents Profile - Shareable AI Coding Agent Configuration
#
# This profile provides the complete agentic development experience with:
# - Claude Code, Cursor, Copilot CLI, Codex, Gemini
# - Custom helper scripts for agent workflows
# - Zellij layouts for multi-agent sessions
# - MCP servers via meta-mcp pattern
#
# Usage:
#   ./dotfiles install -p agents         # Agents only
#   ./dotfiles install -p common,agents  # Full setup with agents

profile:
  name: agents
  priority: 300  # After common profiles

# Homebrew taps
brew_taps:
  - name: anomalyco/tap

# Core agent packages
brew_packages:
  - name: opencode

cask_packages:
  - name: chatgpt
  - name: claude-code
  - name: copilot-cli
  - name: cursor  # Optional - remove if not needed
  - name: codex   # Optional - remove if not needed

# Python CLI package (installed via pipx in editable mode)
# Paths starting with "packages/" are relative to profile_dir
pipx_packages:
  - name: hive-cli
    path: packages/hive_cli
    editable: true

# Enable Cursor CLI installation (via cursor_cli role)
install_cursor_cli: true

# Skills and agents folders - symlink to multiple agent destinations
skill_folders:
  - ~/.claude/skills
  - ~/.cursor/skills

agent_folders:
  - ~/.claude/agents
  - ~/.cursor/agents

# JSON config settings (via json_config role)
# Settings are recursively merged with existing file content
json_configs:
  - file: ~/.claude/settings.json
    create_file: true
    content:
      permissions:
        allow:
          # File discovery & listing
          - "Bash(ls)"
          - "Bash(ls *)"
          - "Bash(find *)"
          - "Bash(tree)"
          - "Bash(tree *)"
          - "Bash(file *)"
          - "Bash(stat *)"
          - "Bash(du *)"
          # Content search
          - "Bash(grep *)"
          - "Bash(rg *)"
          - "Bash(ag *)"
          # File reading
          - "Bash(head *)"
          - "Bash(tail *)"
          - "Bash(bat *)"
          - "Bash(less *)"
          # Text processing
          - "Bash(wc *)"
          - "Bash(sort *)"
          - "Bash(uniq *)"
          - "Bash(cut *)"
          - "Bash(diff *)"
          - "Bash(jq *)"
          - "Bash(yq *)"
          # Git read-only
          - "Bash(git status)"
          - "Bash(git status *)"
          - "Bash(git log)"
          - "Bash(git log *)"
          - "Bash(git diff)"
          - "Bash(git diff *)"
          - "Bash(git show *)"
          - "Bash(git branch)"
          - "Bash(git branch *)"
          - "Bash(git tag)"
          - "Bash(git tag *)"
          - "Bash(git remote)"
          - "Bash(git remote *)"
          - "Bash(git stash list)"
          - "Bash(git stash list *)"
          - "Bash(git ls-tree *)"
          - "Bash(git ls-files)"
          - "Bash(git ls-files *)"
          - "Bash(git rev-parse *)"
          - "Bash(git describe *)"
          - "Bash(git config --get *)"
          - "Bash(git config --get-all *)"
          - "Bash(git config --list)"
          - "Bash(git config --list *)"
          - "Bash(git config -l)"
          - "Bash(git config -l *)"
          - "Bash(git blame *)"
          - "Bash(git shortlog *)"
          # System info
          - "Bash(which *)"
          - "Bash(type *)"
          - "Bash(command -v *)"
          - "Bash(uname)"
          - "Bash(uname *)"
          - "Bash(whoami)"
          - "Bash(hostname)"
          - "Bash(pwd)"
          - "Bash(date)"
          - "Bash(date *)"
          - "Bash(env)"
          - "Bash(printenv)"
          - "Bash(printenv *)"
          # Version & help
          - "Bash(* --version)"
          - "Bash(* --help)"
          - "Bash(* --help *)"
          - "Bash(* -h)"
          # Misc read-only
          - "Bash(test *)"
          - "Bash(readlink *)"
          - "Bash(realpath *)"
          - "Bash(basename *)"
          - "Bash(dirname *)"
      planModeByDefault: true
      statusLine:
        type: command
        command: ~/.claude/statusline-command.py
      hooks:
        Stop:
          - hooks:
              - type: command
                command: ~/.claude/hooks/auto-rename-session.py
        Notification:
          - matcher: idle_prompt
            hooks:
              - type: command
                command: ~/.claude/hooks/pending-input-notify.sh
          - matcher: permission_prompt
            hooks:
              - type: command
                command: ~/.claude/hooks/pending-input-notify.sh
  - file: ~/.cursor/cli-config.json
    content:
      editor:
        vimMode: true
      attribution:
        attributeCommitsToAgent: false

# YAML config settings (via yaml_config role)
yaml_configs:
  - file: ~/.config/hive/hive.yml
    create_file: true
    content:
      zellij:
        layout: agent
      agents:
        order:
          - claude
          - gemini
          - codex
          - agent
          - cursor-agent
          - copilot

# MCP servers - meta-mcp pattern for user customization
# meta-mcp loads servers from ~/.meta-mcp/servers.json
# User configures their own servers in that file
mcp_servers:
  - name: meta-mcp
    command: npx
    args: ["-y", "@justanothermldude/meta-mcp-server@0.1.10"]
    env:
      SERVERS_CONFIG: "~/.meta-mcp/servers.json"
  - name: mcp-exec
    command: npx
    args: ["-y", "@justanothermldude/mcp-exec@1.1.1"]
